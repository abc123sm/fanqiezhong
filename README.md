# 番茄钟 (Go fanqiezhong)

这是一个基于神经可塑性原理设计的番茄钟程序，专为 OBS 直播或个人深度工作设计。

> **设计灵感**：本项目参考了 Andrew Huberman 的文章 [Teach & Learn Better With a “Neuroplasticity Super Protocol”](https://www.hubermanlab.com/newsletter/teach-and-learn-better-with-a-neuroplasticity-super-protocol)，旨在通过科学的休息间隔提高学习和工作效率。

## ✨ 核心特性

-   **科学的随机间隔**：小循环时长可在基础时间上随机浮动，模拟真实神经系统的适应性，避免大脑对固定节奏产生疲劳。
-   **多级循环结构**：
    *   **小循环 (Micro)**：基础专注单元（如 2 分钟 ± 随机偏移）。
    *   **中循环 (Meso)**：由多个小循环组成（如 25 分钟）。
    *   **大循环 (Macro)**：由多个中循环组成（如 3 组），完成后进行长休息。
-   **OBS 直播友好**：提供多种显示模式，包括透明背景的 Web 界面和极简 GUI 窗口，完美融入直播画面。
-   **音频反馈**：不同阶段结束播放特定的提示音，通过听觉强化条件反射。
-   **极低资源占用**：针对直播场景优化，GUI 版本限制为 1 FPS，Web 无头版本零显存占用。

## 🚀 版本选择

我们提供了 5 种不同的版本，以适应不同的使用场景。下载压缩包后解压即可使用。

### 1. 纯净窗口版 (`time_clock_gui_only`) - **推荐个人使用**
*   **包含文件**：`time_clock_gui_only.exe`
*   **界面**：独立小窗口，显示进度条和倒计时。
*   **特点**：无后台 Web 服务，无黑色控制台窗口，资源占用极低。
*   **适用**：桌面挂件，不需要连接 OBS 浏览器源的用户。

### 2. 窗口+Web版 (`time_clock_gui_web`) - **推荐直播使用 (方案 A)**
*   **包含文件**：`time_clock_gui_web.exe`
*   **界面**：独立小窗口 + 本地 Web 服务器 (默认端口 8080)。
*   **特点**：既可以在桌面上看到倒计时，也可以让 OBS 通过浏览器源采集画面。
*   **适用**：主播，需要同时在副屏监控时间和在直播间展示时间。

### 3. 隐形 Web 版 (`time_clock_web_headless`) - **推荐直播使用 (方案 B)**
*   **包含文件**：`time_clock_web_headless.exe`
*   **界面**：**无任何窗口**，无任务栏图标，无控制台黑框。
*   **特点**：纯后台运行，极致静默。
*   **适用**：不仅要省资源，还不想在桌面上看到任何干扰窗口的强迫症用户。只能通过 OBS 浏览器源或浏览器访问 `http://localhost:8080` 查看。
*   **注意**：关闭需使用任务管理器。

### 4. 终端版 (`time_clock_term_only`)
*   **包含文件**：`time_clock_term_only.exe`
*   **界面**：命令行黑框。
*   **特点**：在终端显示文本日志。
*   **适用**：习惯使用命令行的极客。

### 5. 终端+Web版 (`time_clock_term_web`)
*   **包含文件**：`time_clock_term_web.exe`
*   **界面**：命令行黑框 + Web 服务。
*   **特点**：能看到详细的运行日志和错误信息。
*   **适用**：调试故障，或需要查看详细运行状态。

## ⚙️ 配置说明

在解压后的目录中找到 `config.json` 文件进行修改（修改后需重启程序）：

```json
{
    "小循环基础时间秒": 120,      // 设定专注的核心时长
    "小循环随机偏移秒": 30,       // 引入随机性，例如 ±30秒
    "小循环休息时间秒": 10,       // 短暂的微休息
    "中循环总时间分": 25,         // 类似传统番茄钟的一个完整块
    "中循环休息时间分": 5,        // 中循环后的休息
    "中循环组数": 3,              // 连续进行几组后进入大休息
    "大循环休息时间分": 30,       // 深度休息时长
    "端口": 8080                 // Web 服务端口
}
```

## 🎥 OBS 最佳实践

### 方式一：采集 Web 界面 (推荐)
1.  运行 **窗口+Web版** 或 **隐形 Web 版**。
2.  在 OBS 中添加 **"浏览器" (Browser)** 源。
3.  URL 填写：`http://localhost:8080`。
4.  宽度设为 `600`，高度设为 `100`。
5.  勾选 "关闭源时刷新浏览器" (Shutdown source when not visible)。
6.  *Web 界面背景默认为黑色，适合配合 OBS 的“滤镜 -> 色值键 (Color Key)” 去除背景，或者直接使用 CSS 定制。*

### 方式二：采集窗口
1.  运行 **纯净窗口版** 或 **窗口+Web版**。
2.  在 OBS 中添加 **"窗口采集" (Window Capture)**。
3.  选择 "番茄钟状态" 窗口。

## 🛠️ 源码构建

如果你想自己编译修改源码：

```powershell
# 运行构建脚本 (会自动打包所有版本到 dist 目录)
.\build.ps1
```

依赖：
- Go 1.18+
- `github.com/hajimehoshi/ebiten/v2`
- `github.com/gopxl/beep/v2`

## 📝 许可证

MIT License
