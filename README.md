# 番茄钟 (Go fanqiezhong)

这是一个用 Go 语言编写的、高度可配置的番茄钟程序，专为 OBS 直播或个人专注设计。它支持随机化的小循环时间、多级循环结构（小/中/大循环）以及音频提醒功能。

## ✨ 特性

-   **完全可配置**：通过 `config.json` 自定义所有时间参数。
-   **随机小循环**：小循环时长可在基础时间上随机浮动，模拟真实工作节奏，但总时长严格符合中循环设定。
-   **多级循环**：
    *   **小循环 (Micro)**：基础工作单元（如 2 分钟）。
    *   **中循环 (Meso)**：由多个小循环组成（如 25 分钟）。
    *   **大循环 (Macro)**：由多个中循环组成（如 3 组）。
-   **音频提醒**：不同阶段结束播放不同的提示音 (`Sounds/*.mp3`)。
-   **多平台/多模式支持**：提供 4 种不同的运行模式，满足不同需求。
-   **OBS 友好**：提供 Web 界面和极简 GUI 窗口，方便 OBS 采集显示。

## 🚀 快速开始

### 1. 准备工作

确保目录下有 `Sounds` 文件夹，并包含以下音频文件：
-   `warning.mp3` (小循环结束)
-   `succeed.mp3` (休息结束)
-   `info.mp3` (中/大循环结束)

### 2. 选择适合你的版本

程序提供了 4 个可执行文件（构建生成）：

1.  **`time_clock_gui_only.exe` (推荐)**
    *   **界面**：独立小窗口 (300x100)，可自由拉伸。
    *   **特点**：无黑框终端，无后台 Web 服务，最纯净。
    *   **用途**：桌面挂件，本机查看。

2.  **`time_clock_gui_web.exe`**
    *   **界面**：独立小窗口 + Web 服务。
    *   **特点**：同时开启 `0.0.0.0:8080` Web 服务。
    *   **用途**：既想看本机窗口，又想让 OBS 通过浏览器源采集。

3.  **`time_clock_term_only.exe`**
    *   **界面**：仅命令行黑框。
    *   **特点**：无图形界面，体积最小。
    *   **用途**：喜欢命令行或服务器环境运行。

4.  **`time_clock_term_web.exe`**
    *   **界面**：命令行黑框 + Web 服务。
    *   **特点**：开启 Web 服务，能看日志。
    *   **用途**：调试或习惯看日志的用户。

### 3. 配置说明 (`config.json`)

修改 `config.json` 文件以调整参数（修改后需重启程序）：

```json
{
    "小循环基础时间秒": 120,      // 小循环标准时长
    "小循环随机偏移秒": 30,       // 随机浮动范围 (例如 ±30秒)
    "小循环休息时间秒": 10,       // 小循环后的休息时长
    "中循环总时间分": 25,         // 一个中循环的总目标时长
    "中循环休息时间分": 5,        // 中循环后的休息时长
    "中循环组数": 3,              // 一个大循环包含几个中循环
    "大循环休息时间分": 30,       // 大循环后的长休息
    "端口": 8080                 // Web 服务端口 (仅 Web 版有效)
}
```

## 🎥 OBS 设置指南

### 方法 A：使用 GUI 窗口 (推荐)
1. 运行 `time_clock_gui_only.exe`。
2. 在 OBS 中添加 **"窗口采集" (Window Capture)**。
3. 选择 "番茄钟状态" 窗口。
4. 按住 `Alt` 键裁剪不需要的边框，或直接使用窗口画面。

### 方法 B：使用 Web 浏览器源
1. 运行 `time_clock_gui_web.exe` 或 `time_clock_term_web.exe`。
2. 在 OBS 中添加 **"浏览器" (Browser)** 源。
3. URL 填写：`http://localhost:8080` (或你配置的端口)。
4. 宽度设为 `600`，高度设为 `100`。
5. 勾选 "关闭源时刷新浏览器" (Shutdown source when not visible)。

## 🛠️ 开发构建

如果你需要自行编译代码：

```powershell
# 运行构建脚本 (需要 Go 1.18+)
.\build.ps1
```

依赖库：
- GUI: `github.com/hajimehoshi/ebiten/v2`
- Audio: `github.com/gopxl/beep/v2`

## 📝 许可证

MIT
